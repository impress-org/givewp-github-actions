name: Push POT file to translations.stellarwp.com
description: Pushes the plugin POT file to translations.stellarwp.com for translations

inputs:
    plugin_slug:
        description: 'Plugin Slug'
        required: true

runs:
    using: "composite"
    steps:
        -   name: Deploy POT file to translations.stellarwp.com
            uses: burnett01/rsync-deployments@4.1
            with:
                switches: -avz --omit-dir-times --no-perms
                path: ${{github.workspace}}/languages/${{ inputs.plugin_slug }}.pot
                remote_path: ${{ secrets.TRANSLATIONS_DEPLOY_POT_LOCATION }}givewp/
                remote_host: ${{ secrets.TRANSLATIONS_DEPLOY_HOST }}
                remote_user: ${{ secrets.TRANSLATIONS_DEPLOY_USER }}
                remote_key: ${{ secrets.TRANSLATIONS_DEPLOY_SSH_KEY }}

        -   name: SSH to Translations StellarWP Website
            uses: appleboy/ssh-action@master
            with:
                host: ${{ secrets.TRANSLATIONS_DEPLOY_HOST }}
                username: ${{ secrets.TRANSLATIONS_DEPLOY_USER }}
                key: ${{ secrets.TRANSLATIONS_DEPLOY_SSH_KEY }}
                script: |
                    pwd
                    cd translations.stellarwp.com/html/
                    wp glotpress import-originals givewp/${{ inputs.plugin_slug }} ${{ secrets.TRANSLATIONS_DEPLOY_POT_LOCATION }}givewp/${{ inputs.plugin_slug }}.pot
